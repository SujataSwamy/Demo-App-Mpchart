language: android
jdk:
- oraclejdk8
sudo: required
dist: trusty
env:
  global:
  - BRANCH_NAME=master
android:
  components:
  - tools
  - platform-tools
  - build-tools-27.0.3
  - tools
  - android-24
  - extra-android-m2repository
  - extra-google-m2repository
  - extra-google-google_play_services
before_cache:
- rm -f $HOME/.gradle/caches/modules-2/modules-2.lock
cache:
  directories:
  - "$HOME/.gradle/caches/"
  - "$HOME/.gradle/wrapper/"
before_install:
- openssl aes-256-cbc -K $encrypted_783d9be09488_key -iv $encrypted_783d9be09488_iv
  -in travis-ci-demo-4efee-0e9f1d0f0fd2.json.enc -out travis-ci-demo-4efee-0e9f1d0f0fd2.json
  -d
- echo y | sdkmanager "ndk-bundle"
before_script:
- env

script:
  - ./gradlew clean build connectedCheck -PdisablePreDex --stacktrace
    - ./gradlew build assembleDebug
    - gcloud components update
    - gcloud firebase test android run --app app/build/outputs/apk/debug/app-debug.apk --type=robo --device model=Nexus4,version=19


